#  docker-compose -f docker-compose.yml config check validate config
version: "3.1"
services:
  fastify-server-dev:
    image: node:22-alpine
    command: npm run dev
    working_dir: /app
    ports:
    - "3000:3000"
    expose:
    - "3000"
    restart: always
    labels:
      com.docker.compose.project: "fastify"
      virtual.host: "api.fastify.local.com"
      virtual.tls-email: your@email.com
      virtual.port: "3000"
    environment:
      VIRTUAL_HOST: "api.fastify.local.com"
      VIRTUAL_PORT: "3000"
      LETSENCRYPT_HOST: "api.fastify.local.com"
      LETSENCRYPT_EMAIL: your@email.com
      TZ: Asia/Bangkok
      CHOKIDAR_USEPOLLING: true   # üëà ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!
      CHOKIDAR_INTERVAL: 1000     # ‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏∏‡∏Å 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ)      
    volumes:
      - ./fastify:/app

    logging:
      # ‡πÉ‡∏ä‡πâ json-file driver (default)
      driver: "json-file"
      options:
        # ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå log ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏ô 10MB
        # ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå log ‡πÑ‡∏ß‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡πÑ‡∏ü‡∏•‡πå
        max-size: "10m"
        max-file: "5"

networks:
  default:
    external: true
    name: proxy-network
